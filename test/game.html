<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Panel Layout</title>
  </head>
  <body>
    <div class="app">
      <!-- Panels -->

      <section class="panel card" data-panel="instellingen">
        <div class="hd">Instellingen</div>
        <div class="bd col">
          <div>
            <h3>Opdrachten</h3>
            <p class="muted">
              Kies hier welke opdrachten er gebruikt worden in het spel.
            </p>
            <div id="settings_tasks"></div>
          </div>

          <div class="row">
            <button class="btn" data-panel="hoofdmenu">Hoofdmenu</button>
          </div>
        </div>
      </section>

      <section class="panel card" data-panel="spel">
        <div class="hd">Spel</div>
        <div class="bd muted">Inhoud voor spel</div>
      </section>

      <section class="panel card" data-panel="opdracht">
        <div class="hd">Opdracht</div>
        <div class="bd muted">Inhoud voor opdracht</div>
      </section>

      <section class="panel card" data-panel="registratie">
        <div class="hd">Speler Registratie</div>
        <div class="bd muted">Inhoud voor registratie</div>
      </section>
    </div>

    <!-- ==== Game: data + helpers ==== -->
    <script>

      // Basis spelverloop-model (kan je later uitbreiden)
      const GAME_FLOW_MODEL = {
        version: 1,
        activePanel: "hoofdmenu",
        round: 1,
        turnIndex: 0,
        players: [], // je kunt hier straks createPlayer() instances in zetten
        settings: {}, // later: maxRolls, pointsToSafe, enz.
        tasks: {
          // ===== KLEDING =====
          undress_self: {
            name: "Uitkleden (Zelf - Basis)",
            desc: "Het uittrekken of verwijderen van een kledingstuk bij jezelf.",
            enabled: true,
            weight: 100,
            tasks: generateClothingTasks("Trek uit of verwijder"),
          },
          undress_other: {
            name: "Uitkleden (Ander - Basis)",
            desc: "Het uittrekken of verwijderen van een kledingstuk bij een ander.",
            enabled: true,
            weight: 100,
            tasks: generateClothingTasks("Trek uit of verwijder"),
          },
          dress_self: {
            name: "Aankleden (Zelf - Basis)",
            desc: "Het aantrekken of aanpassen van kleding bij jezelf.",
            enabled: true,
            weight: 100,
            tasks: generateClothingTasks("Trek aan of plaats"),
          },
          dress_other: {
            name: "Aankleden (Ander - Basis)",
            desc: "Het aantrekken of aanpassen van kleding bij een ander.",
            enabled: true,
            weight: 100,
            tasks: generateClothingTasks("Trek aan of plaats"),
          },

          // ===== EXPOSURE =====
          exposure_self_base: {
            name: "Onthulling (Zelf - Basis)",
            desc: "Het onthullen of zichtbaar maken van lichaamsdelen of kleding bij jezelf met basis-karakter (bijv. buik, rug, schouder).",
            enabled: true,
            weight: 100,
            tasks: [],
          },
          exposure_self_sensual: {
            name: "Onthulling (Zelf - Sensueel)",
            desc: "Het onthullen of zichtbaar maken van lichaamsdelen of kleding bij jezelf met sensueel uitdagende insteek (bijv. borst/borstlijn, dij, binnenbeen).",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          exposure_self_sexual: {
            name: "Onthulling (Zelf - Seksueel)",
            desc: "Het onthullen of zichtbaar maken van lichaamsdelen of kleding bij jezelf met seksueel doel (bijv. geslachtsdelen).",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          exposure_other_base: {
            name: "Onthulling (Ander - Basis)",
            desc: "Het onthullen of zichtbaar maken van lichaamsdelen of kleding bij een ander met basis-karakter (door jouw actie, niet op verzoek; bijv. buik, rug, schouder).",
            enabled: true,
            weight: 100,
            tasks: [],
          },
          exposure_other_sensual: {
            name: "Onthulling (Ander - Sensueel)",
            desc: "Het onthullen of zichtbaar maken van lichaamsdelen of kleding bij een ander met sensueel uitdagende insteek (door jouw actie; bijv. borst/borstlijn, dij, binnenbeen).",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          exposure_other_sexual: {
            name: "Onthulling (Ander - Seksueel)",
            desc: "Het onthullen of zichtbaar maken van lichaamsdelen of kleding bij een ander met seksueel doel (door jouw actie; bijv. geslachtsdelen).",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          // ===== POSES =====
          pose_self_innocent: {
            name: "Pose (Zelf - Onschuldig)",
            desc: "Het aannemen van een houding of pose bij jezelf met onschuldige insteek.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          pose_self_playful: {
            name: "Pose (Zelf - Speels)",
            desc: "Het aannemen van een houding of pose bij jezelf met speelse insteek.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          pose_self_romantic: {
            name: "Pose (Zelf - Romantisch)",
            desc: "Het aannemen van een houding of pose bij jezelf met romantische insteek.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          pose_self_sensual: {
            name: "Pose (Zelf - Sensueel)",
            desc: "Het aannemen van een houding of pose bij jezelf met sensueel uitdagende insteek.",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          pose_self_sexual: {
            name: "Pose (Zelf - Seksueel)",
            desc: "Het aannemen van een houding of pose bij jezelf met seksueel doel.",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          pose_other_innocent: {
            name: "Pose (Ander - Onschuldig)",
            desc: "Het aannemen van een houding of pose gericht op een ander met onschuldige insteek.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          pose_other_playful: {
            name: "Pose (Ander - Speels)",
            desc: "Het aannemen van een houding of pose gericht op een ander met speelse insteek.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          pose_other_romantic: {
            name: "Pose (Ander - Romantisch)",
            desc: "Het aannemen van een houding of pose gericht op een ander met romantische insteek.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          pose_other_sensual: {
            name: "Pose (Ander - Sensueel)",
            desc: "Het aannemen van een houding of pose gericht op een ander met sensueel uitdagende insteek.",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          pose_other_sexual: {
            name: "Pose (Ander - Seksueel)",
            desc: "Het aannemen van een houding of pose gericht op een ander met seksueel doel.",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          // ===== MOVEMENT =====
          movement_self_innocent: {
            name: "Beweging (Zelf - Onschuldig)",
            desc: "Het uitvoeren van een beweging door jezelf met onschuldige insteek.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          movement_self_playful: {
            name: "Beweging (Zelf - Speels)",
            desc: "Het uitvoeren van een beweging door jezelf met speelse insteek.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          movement_self_romantic: {
            name: "Beweging (Zelf - Romantisch)",
            desc: "Het uitvoeren van een beweging door jezelf met romantische insteek.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          movement_self_sensual: {
            name: "Beweging (Zelf - Sensueel)",
            desc: "Het uitvoeren van een beweging door jezelf met sensueel uitdagende insteek.",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          movement_self_sexual: {
            name: "Beweging (Zelf - Seksueel)",
            desc: "Het uitvoeren van een beweging door jezelf met seksueel doel.",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          // ===== TEASE =====
          tease_self_innocent: {
            name: "Teasen (Zelf - Onschuldig)",
            desc: "Het uitdagen of verleiden (teasen) door bij jezelf iets te doen met onschuldige insteek.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          tease_self_playful: {
            name: "Teasen (Zelf - Speels)",
            desc: "Het uitdagen of verleiden (teasen) door bij jezelf iets te doen met speelse insteek.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          tease_self_romantic: {
            name: "Teasen (Zelf - Romantisch)",
            desc: "Het uitdagen of verleiden (teasen) door bij jezelf iets te doen met romantische insteek.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          tease_self_sensual: {
            name: "Teasen (Zelf - Sensueel)",
            desc: "Het uitdagen of verleiden (teasen) door bij jezelf iets te doen met sensueel uitdagende insteek.",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          tease_self_sexual: {
            name: "Teasen (Zelf - Seksueel)",
            desc: "Het uitdagen of verleiden (teasen) door bij jezelf iets te doen met seksueel doel.",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          tease_self_sexual_oral: {
            name: "Teasen (Zelf - Seksueel - Oraal)",
            desc: "Het uitdagen of verleiden (teasen) door bij jezelf iets te doen met seksueel doel binnen het orale domein.",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          tease_self_sexual_genital: {
            name: "Teasen (Zelf - Seksueel - Genitaal)",
            desc: "Het uitdagen of verleiden (teasen) door bij jezelf iets te doen met seksueel doel rond het genitale gebied (penis of vagina).",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          tease_self_sexual_anal: {
            name: "Teasen (Zelf - Seksueel - Anaal)",
            desc: "Het uitdagen of verleiden (teasen) door bij jezelf iets te doen met seksueel doel rond het anale gebied.",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          tease_other_innocent: {
            name: "Teasen (Ander - Onschuldig)",
            desc: "Het uitdagen of verleiden (teasen) door bij een ander iets te doen met onschuldige insteek.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          tease_other_playful: {
            name: "Teasen (Ander - Speels)",
            desc: "Het uitdagen of verleiden (teasen) door bij een ander iets te doen met speelse insteek.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          tease_other_romantic: {
            name: "Teasen (Ander - Romantisch)",
            desc: "Het uitdagen of verleiden (teasen) door bij een ander iets te doen met romantische insteek.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          tease_other_sensual: {
            name: "Teasen (Ander - Sensueel)",
            desc: "Het uitdagen of verleiden (teasen) door bij een ander iets te doen met sensueel uitdagende insteek.",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          tease_other_sexual: {
            name: "Teasen (Ander - Seksueel)",
            desc: "Het uitdagen of verleiden (teasen) door bij een ander iets te doen met seksueel doel.",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          tease_other_sexual_oral: {
            name: "Teasen (Ander - Seksueel - Oraal)",
            desc: "Het uitdagen of verleiden (teasen) door bij een ander iets te doen met seksueel doel binnen het orale domein.",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          tease_other_sexual_genital: {
            name: "Teasen (Ander - Seksueel - Genitaal)",
            desc: "Het uitdagen of verleiden (teasen) door bij een ander iets te doen met seksueel doel rond het genitale gebied (penis of vagina).",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          tease_other_sexual_anal: {
            name: "Teasen (Ander - Seksueel - Anaal)",
            desc: "Het uitdagen of verleiden (teasen) door bij een ander iets te doen met seksueel doel rond het anale gebied.",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          // ===== TOUCH =====
          touch_self_innocent: {
            name: "Aanraking (Zelf - Onschuldig)",
            desc: "Het aanraken bij jezelf met onschuldige insteek.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          touch_self_playful: {
            name: "Aanraking (Zelf - Speels)",
            desc: "Het aanraken bij jezelf met speelse insteek.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          touch_self_romantic: {
            name: "Aanraking (Zelf - Romantisch)",
            desc: "Het aanraken bij jezelf met romantische insteek.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          touch_self_sensual: {
            name: "Aanraking (Zelf - Sensueel)",
            desc: "Het aanraken bij jezelf met sensueel uitdagende insteek.",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          touch_self_sexual: {
            name: "Aanraking (Zelf - Seksueel)",
            desc: "Het aanraken bij jezelf met seksueel doel.",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          touch_self_sexual_genital: {
            name: "Aanraking (Zelf - Seksueel - Genitaal)",
            desc: "Het aanraken bij jezelf met seksueel doel rond het genitale gebied (penis of vagina).",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          touch_self_sexual_anal: {
            name: "Aanraking (Zelf - Seksueel - Anaal)",
            desc: "Het aanraken bij jezelf met seksueel doel rond het anale gebied.",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          touch_other_innocent: {
            name: "Aanraking (Ander - Onschuldig)",
            desc: "Het aanraken bij een ander met onschuldige insteek.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          touch_other_playful: {
            name: "Aanraking (Ander - Speels)",
            desc: "Het aanraken bij een ander met speelse insteek.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          touch_other_romantic: {
            name: "Aanraking (Ander - Romantisch)",
            desc: "Het aanraken bij een ander met romantische insteek.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          touch_other_sensual: {
            name: "Aanraking (Ander - Sensueel)",
            desc: "Het aanraken bij een ander met sensueel uitdagende insteek.",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          touch_other_sexual: {
            name: "Aanraking (Ander - Seksueel)",
            desc: "Het aanraken bij een ander met seksueel doel (niet specifiek genitaal of anaal).",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          touch_other_sexual_genital: {
            name: "Aanraking (Ander - Seksueel - Genitaal)",
            desc: "Het aanraken bij een ander met seksueel doel rond het genitale gebied (penis of vagina).",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          touch_other_sexual_anal: {
            name: "Aanraking (Ander - Seksueel - Anaal)",
            desc: "Het aanraken bij een ander met seksueel doel rond het anale gebied.",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          // ===== INTERACTIE =====
          interaction_other_innocent: {
            name: "Interactie (Ander - Onschuldig)",
            desc: "Het uitvoeren van een handeling of interactie bij een ander met onschuldige insteek.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          interaction_other_playful: {
            name: "Interactie (Ander - Speels)",
            desc: "Het uitvoeren van een handeling of interactie bij een ander met speelse insteek.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          interaction_other_romantic: {
            name: "Interactie (Ander - Romantisch)",
            desc: "Het uitvoeren van een handeling of interactie bij een ander met romantische insteek.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          interaction_other_sensual: {
            name: "Interactie (Ander - Sensueel)",
            desc: "Het uitvoeren van een handeling of interactie bij een ander met sensueel uitdagende insteek.",
            enabled: true,
            weight: 20,
            tasks: [],
          },

          interaction_other_sexual: {
            name: "Interactie (Ander - Seksueel)",
            desc: "Het uitvoeren van een handeling of interactie bij een ander met seksueel doel (niet specifiek oraal, genitaal, anaal of handmatig).",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          interaction_other_sexual_oral: {
            name: "Interactie (Ander - Seksueel - Oraal)",
            desc: "Het uitvoeren van een handeling of interactie bij een ander met seksueel doel binnen het orale domein.",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          interaction_other_sexual_genital: {
            name: "Interactie (Ander - Seksueel - Genitaal)",
            desc: "Het uitvoeren van een handeling of interactie bij een ander met seksueel doel rond het genitale domein (penis of vagina).",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          interaction_other_sexual_anal: {
            name: "Interactie (Ander - Seksueel - Anaal)",
            desc: "Het uitvoeren van een handeling of interactie bij een ander met seksueel doel binnen het anale domein.",
            enabled: true,
            weight: 0,
            tasks: [],
          },
          interaction_other_sexual_manual: {
            name: "Interactie (Ander - Seksueel - Handmatig)",
            desc: "Het uitvoeren van een handeling of interactie bij een ander met seksueel doel via handmatige stimulatie (handen of vingers).",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          // ===== ROLEPLAY =====
          roleplay_other_innocent: {
            name: "Rollenspel (Onschuldig)",
            desc: "Het uitvoeren van een rollenspel gericht op een ander met onschuldige insteek; rollenspel kan elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          roleplay_other_playful: {
            name: "Rollenspel (Speels)",
            desc: "Het uitvoeren van een rollenspel gericht op een ander met speelse insteek; rollenspel kan elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          roleplay_other_romantic: {
            name: "Rollenspel (Romantisch)",
            desc: "Het uitvoeren van een rollenspel gericht op een ander met romantische insteek; rollenspel kan elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          roleplay_other_sensual: {
            name: "Rollenspel (Sensueel)",
            desc: "Het uitvoeren van een rollenspel gericht op een ander met sensueel uitdagende insteek; rollenspel kan elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          roleplay_other_sexual: {
            name: "Rollenspel (Seksueel)",
            desc: "Het uitvoeren van een rollenspel gericht op een ander met seksueel doel; rollenspel kan elementen uit alle domeinen omvatten, ongeacht andere categorie-instellingen.",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          // ===== CHALLENGES =====
          challenge_self_innocent: {
            name: "Challenge (Zelf - Onschuldig)",
            desc: "Het uitvoeren van een uitdaging bij jezelf met onschuldige insteek; uitdagingen kunnen elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          challenge_self_playful: {
            name: "Challenge (Zelf - Speels)",
            desc: "Het uitvoeren van een uitdaging bij jezelf met speelse insteek; uitdagingen kunnen elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          challenge_self_romantic: {
            name: "Challenge (Zelf - Romantisch)",
            desc: "Het uitvoeren van een uitdaging bij jezelf met romantische insteek; uitdagingen kunnen elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          challenge_self_sensual: {
            name: "Challenge (Zelf - Sensueel)",
            desc: "Het uitvoeren van een uitdaging bij jezelf met sensueel uitdagende insteek; uitdagingen kunnen elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          challenge_self_sexual: {
            name: "Challenge (Zelf - Seksueel)",
            desc: "Het uitvoeren van een uitdaging bij jezelf met seksueel doel; uitdagingen kunnen elk domein omvatten, ongeacht andere categorie-instellingen.",
            enabled: true,
            weight: 0,
            tasks: [],
          },

          challenge_other_innocent: {
            name: "Challenge (Ander - Onschuldig)",
            desc: "Het uitvoeren van een uitdaging met of gericht op een ander met onschuldige insteek; uitdagingen kunnen elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 80,
            tasks: [],
          },
          challenge_other_playful: {
            name: "Challenge (Ander - Speels)",
            desc: "Het uitvoeren van een uitdaging met of gericht op een ander met speelse insteek; uitdagingen kunnen elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 60,
            tasks: [],
          },
          challenge_other_romantic: {
            name: "Challenge (Ander - Romantisch)",
            desc: "Het uitvoeren van een uitdaging met of gericht op een ander met romantische insteek; uitdagingen kunnen elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 40,
            tasks: [],
          },
          challenge_other_sensual: {
            name: "Challenge (Ander - Sensueel)",
            desc: "Het uitvoeren van een uitdaging met of gericht op een ander met sensueel uitdagende insteek; uitdagingen kunnen elementen bevatten die niet worden beperkt door andere categorie-instellingen.",
            enabled: true,
            weight: 20,
            tasks: [],
          },
          challenge_other_sexual: {
            name: "Challenge (Ander - Seksueel)",
            desc: "Het uitvoeren van een uitdaging met of gericht op een ander met seksueel doel; uitdagingen kunnen elk domein omvatten, ongeacht andere categorie-instellingen.",
            enabled: true,
            weight: 0,
            tasks: [],
          },
        },
      };

      // Helper: dynamisch taken vullen op basis van CLOTHING_MODEL
      function generateClothingTasks(action) {
        const tasks = [];

        for (const [key, item] of Object.entries(CLOTHING_MODEL)) {
          tasks.push({
            name: `undress_${key}`,
            instruction: `${action} bij {target} ${item.name.toLowerCase()}.`,
            description: `Opdracht: ${action} bij {target} ${item.name.toLowerCase()} – ${
              item.desc
            }`,
          });
        }

        return tasks;
      }

    </script>

    <!-- ==== Settings: helpers ==== -->
    <script>
      // Render toggles voor alle task-categorieën in window.GAME.tasks
      function renderTaskSettings(
        targetId = "settings_tasks",
        includeEmpty = false
      ) {
        const root = document.getElementById(targetId);
        if (!root) return;

        root.innerHTML = "";

        const tasks = window.GAME && window.GAME.tasks ? window.GAME.tasks : {};

        // Eerst alles nalopen en categorieën zonder taken uitschakelen
        for (const [key, cfg] of Object.entries(tasks)) {
          if (!Array.isArray(cfg?.tasks) || cfg.tasks.length === 0) {
            cfg.enabled = false;
          }
        }

        // Save disabled empty task categories
        storageSaveGame(window.GAME);

        // Dan alleen entries opnemen die aan de filter voldoen
        const entries = Object.entries(tasks)
          .filter(
            ([_, cfg]) =>
              includeEmpty ||
              (Array.isArray(cfg?.tasks) && cfg.tasks.length > 0)
          )
          .sort((a, b) => {
            const aName =
              a[1] && typeof a[1].name === "string" ? a[1].name : a[0];
            const bName =
              b[1] && typeof b[1].name === "string" ? b[1].name : b[0];
            return aName.localeCompare(bName);
          });

        entries.forEach(([key, cfg]) => {
          const name = cfg?.name ?? key;
          const desc = cfg?.desc ?? "";
          const enabled = !!cfg?.enabled;

          const row = document.createElement("div");
          row.style.borderBottom = "1px solid var(--border)";
          row.style.padding = "12px 0";
          row.style.display = "flex";
          row.style.gap = "12px";
          row.style.alignItems = "flex-start";

          const toggleWrap = document.createElement("div");
          const input = document.createElement("input");
          input.type = "checkbox";
          input.id = `task-${key}`;
          input.checked = enabled;
          input.style.width = "18px";
          input.style.height = "18px";
          input.style.cursor = "pointer";
          toggleWrap.appendChild(input);

          const textCol = document.createElement("div");
          textCol.style.display = "flex";
          textCol.style.flexDirection = "column";
          textCol.style.gap = "4px";

          const title = document.createElement("label");
          title.htmlFor = input.id;
          title.textContent = name;
          title.style.fontWeight = "600";
          title.style.cursor = "pointer";

          const description = document.createElement("div");
          description.className = "muted";
          description.textContent = desc;

          textCol.appendChild(title);
          textCol.appendChild(description);

          row.appendChild(toggleWrap);
          row.appendChild(textCol);
          root.appendChild(row);

          input.addEventListener("change", () => {
            if (window.GAME?.tasks?.[key]) {
              window.GAME.tasks[key].enabled = input.checked;
              if (typeof storageSaveGame === "function") {
                storageSaveGame(window.GAME);
              }
            }
          });
        });

        if (entries.length === 0) {
          const empty = document.createElement("div");
          empty.className = "muted";
          empty.style.padding = "8px 0";
          empty.textContent = "Geen categorieën gevonden.";
          root.appendChild(empty);
        }
      }

      // Voorbeeld: aanroepen nadat GAME geladen is of wanneer je het Instellingen-paneel opent
      renderTaskSettings();
    </script>
  </body>
</html>
